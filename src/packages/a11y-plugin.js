import t from"@swup/plugin";import e from"on-demand-live-region";import"focus-options-polyfill";class n extends t{constructor(t){void 0===t&&(t={}),super(),this.name="SwupA11yPlugin",this.requires={swup:">=4"},this.defaults={contentSelector:"main",headingSelector:"h1, h2, [role=heading]",announcementTemplate:"Navigated to: {title}",urlTemplate:"New page at {url}"},this.options=void 0,this.liveRegion=void 0,this.options={...this.defaults,...t},this.liveRegion=new e}mount(){this.on("visit:start",this.markAsBusy),this.on("visit:end",this.unmarkAsBusy),this.on("content:replace",this.announceVisit)}markAsBusy(){document.documentElement.setAttribute("aria-busy","true")}unmarkAsBusy(){document.documentElement.removeAttribute("aria-busy")}announceVisit(){requestAnimationFrame(()=>{this.announcePageName(),this.focusPageContent()})}announcePageName(){const{contentSelector:t,headingSelector:e,urlTemplate:n,announcementTemplate:o}=this.options;let i=n.replace("{url}",window.location.pathname);document.title&&(i=document.title);const s=document.querySelector(t);if(s){const t=s.querySelectorAll(e);if(t&&t.length){const[e]=t;i=e.getAttribute("aria-label")||e.textContent||i}}const a=o.replace("{title}",i.trim());this.liveRegion.say(a)}focusPageContent(){const t=document.querySelector(this.options.contentSelector);t&&(t.setAttribute("tabindex","-1"),t.focus({preventScroll:!0}))}}export{n as default};
//# sourceMappingURL=index.module.js.map
