import t from"@swup/plugin";import e from"morphdom";const n={INPUT:!0,TEXTAREA:!0,SELECT:!0},o={INPUT:!0,TEXTAREA:!0,OPTION:!0},r={"datetime-local":!0,"select-multiple":!0,"select-one":!0,color:!0,date:!0,datetime:!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,textarea:!0,time:!0,url:!0,week:!0},s=[function(t,e){return!(!o[t.tagName]&&t.isEqualNode(e))},function(t,e){const o=t.closest("[data-morph-persist]");if(!o&&n[(s=t).tagName]&&r[s.type]&&t===document.activeElement){const n={value:!0};return Array.from(e.attributes).forEach(e=>{n[e.name]||t.setAttribute(e.name,e.value)}),!1}var s;return!o},function(t,e){return t!==document.activeElement||!t.isContentEditable}];class i extends t{constructor(t){super(),this.name="SwupMorphPlugin",this.requires={swup:">=4"},this.defaults={containers:[],updateCallbacks:[]},this.options=void 0,this.validateContainers=t=>{t.containers=t.containers.filter(t=>!this.options.containers.includes(t))},this.morphContainers=(t,n)=>{let{page:o}=n;const r=this.getContainers(),i=this.getNewContainers(o),a=this.options.updateCallbacks||[];r.forEach((t,n)=>{let{element:o,selector:r}=t;const{element:l}=i[n];o&&l?function(t,n,o){void 0===o&&(o=[]);const r=[...s,...o];e(t,n,{onBeforeElUpdated:(t,e)=>function(t,e,n){return!n.map(n=>"function"!=typeof n||n(t,e)).includes(!1)}(t,e,r)})}(o,l,a):console.warn(`SwupMorphPlugin: No container found for selector: ${r}`)})},this.options={...this.defaults,...t}}mount(){this.before("content:replace",this.validateContainers,{priority:1}),this.on("content:replace",this.morphContainers)}getContainers(t){return void 0===t&&(t=document),this.options.containers.map(e=>({element:t.querySelector(e),selector:e}))}getNewContainers(t){let{html:e}=t;const n=(new DOMParser).parseFromString(e,"text/html");return this.getContainers(n)}}export{i as default};
//# sourceMappingURL=index.module.js.map
